<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ohio Skin Vault • Black Market Wiki</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="scanlines"></div>
  
  <header class="wiki-header">
    <h1>OHIO SKIN VAULT</h1>
    <p class="subtitle">Black Market Values • Community Wiki • Updated November 28, 2025</p>
    <div class="search-bar">
      <input type="text" id="search" placeholder="Search 758 skins..." autocomplete="off">
    </div>
  </header>

  <main class="wiki-container" id="content"></main>

  <footer class="wiki-footer">
    <p>Ohio Trading & Exchange Co. • All values community-sourced • Use at own risk</p>
  </footer>

  <script src="skins.js"></script>
  <script>
    const skins = embeddedSkins || [];
    const content = document.getElementById("content");
    const searchInput = document.getElementById("search");

    // Group by prefix exactly as in your original order
    const groups = [];
    const seen = new Set();

    const prefixes = [
      "Invisible", "Obsidian", "Dark Matter", "Anti Matter", "Crimson Bloods",
      "Void Reapers", "Underworld", "White Ghost", "Solid Gold", "Gift Wrapped",
      "Christmas Future", "Golden Snow", "Frozen Gold", "Sub Zero", "Rainbow Firework",
      "Solid Gold V2", "St Patrick", "Holy Fire", "Bloody Heart", "Fallout",
      "Atomic Pumpkin", "Ethereal", "Spectral", "Balloon"
    ];

    prefixes.forEach(prefix => {
      const group = skins.filter(s => {
        const matches = s.name.startsWith(prefix) || s.name.includes(prefix);
        if (matches && !seen.has(s.name)) {
          seen.add(s.name);
          return true;
        }
        return false;
      });
      if (group.length > 0) groups.push({ name: prefix, skins: group });
    });

    // Catch any leftovers (rare/event skins)
    const leftovers = skins.filter(s => !seen.has(s.name));
    if (leftovers.length > 0) {
      groups.push({ name: "Limited & Event", skins: leftovers });
    }

    function formatWorth(n) {
      if (n === 0) return "Unrated";
      if (n >= 1000000) return "$" + (n / 1000000).toFixed(1) + "M";
      if (n >= 1000) return "$" + Math.floor(n / 1000) + "K";
      return "$" + n;
    }

    function getDemandClass(d) {
      if (!d || d === "?") return "unknown";
      const num = parseFloat(d);
      if (num >= 9) return "insane";
      if (num >= 8) return "high";
      if (num >= 6) return "med";
      return "low";
    }

    function render() {
      const query = searchInput.value.toLowerCase();
      content.innerHTML = "";

      groups.forEach(group => {
        const filtered = group.skins.filter(s => s.name.toLowerCase().includes(query));
        if (filtered.length === 0) return;

        const section = document.createElement("section");
        section.className = "category";
        section.innerHTML = `
          <h2 class="category-title">
            ${group.name} <span class="count">${filtered.length}</span>
          </h2>
          <div class="grid">
            ${filtered.map(s => `
              <div class="skin-card" data-demand="${getDemandClass(s.demand)}">
                <div class="rarity-badge">${group.name.split(" ")[0].toUpperCase()}</div>
                <h3>${s.name}</h3>
                <div class="value">${formatWorth(s.worth)}</div>
                <div class="demand">
                  Demand: <span class="demand-value ${getDemandClass(s.demand)}">
                    ${s.demand === "?" ? "Unknown" : s.demand + "/10"}
                  </span>
                </div>
              </div>
            `).join("")}
          </div>
        `;
        content.appendChild(section);
      });
    }

    searchInput.addEventListener("input", () => {
      render();
    });

    render();
  </script>
</body>
</html>
